latitude_raster <- longitude_raster <- raster(nrows = KEN_alt %>% nrow(),
ncols = KEN_alt %>% ncol(),
ext = KEN_alt %>% extent())
longitude_raster[] <- coordinates(longitude_raster)[,1]
latitude_raster[] <- coordinates(latitude_raster)[,2]
pred_stack <- stack(KEN_alt, KEN_bioclim_resamp, KEN_lakes_r_resamp,
longitude_raster, latitude_raster)
names(pred_stack) <- c('alt', 'bio12', 'lakes', 'long', 'lat')
matern2 <- spaMM::fitme(cbind(tri_np, round(tri_nneg)) ~
alt + bio12 + lakes +
Matern(1|lat+long),
data=STH_kenya_df, family=binomial())
predicted_risk <- raster::predict(pred_stack, matern2, type='response')
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
raster_colorPal <- colorNumeric(palette = topo.colors(64), domain = values(predicted_risk),
na.color = NA)
map_kenya <- basemap %>%
addRasterImage(x = predicted_risk, color = raster_colorPal) %>%
addPolygons(data = KEN_Adm_0, fillOpacity = 0, color = "grey", weight = 3)
map_kenya <- map_kenya %>%
addLegend(title = "Predicted risk, whipworm prevalence",
values = values(predicted_risk),
pal = raster_colorPal)
map_kenya
latitude_raster <- longitude_raster <- raster(nrows = KEN_alt %>% nrow(),
ncols = KEN_alt %>% ncol(),
ext = KEN_alt %>% extent())
longitude_raster[] <- coordinates(longitude_raster)[,1]
latitude_raster[] <- coordinates(latitude_raster)[,2]
pred_stack <- stack(KEN_alt, KEN_bioclim_resamp, KEN_lakes_r_resamp,
longitude_raster, latitude_raster)
names(pred_stack) <- c('alt', 'bio12', 'lakes', 'long', 'lat')
matern2 <- spaMM::fitme(cbind(tri_np, round(tri_nneg)) ~
alt + bio12 + lakes +
Matern(1|lat+long),
data=STH_kenya_df, family=binomial())
predicted_risk <- raster::predict(pred_stack, matern2, type='response')
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
raster_colorPal <- colorNumeric(palette = topo.colors(64), domain = values(predicted_risk),
na.color = NA)
map_kenya <- basemap %>%
addRasterImage(x = predicted_risk, color = raster_colorPal) %>%
addPolygons(data = KEN_Adm_0, fillOpacity = 0, color = "grey", weight = 3)
map_kenya <- map_kenya %>%
addLegend(title = "Predicted risk, whipworm prevalence",
values = values(predicted_risk),
pal = raster_colorPal)
latitude_raster <- longitude_raster <- raster(nrows = KEN_alt %>% nrow(),
ncols = KEN_alt %>% ncol(),
ext = KEN_alt %>% extent())
longitude_raster[] <- coordinates(longitude_raster)[,1]
latitude_raster[] <- coordinates(latitude_raster)[,2]
pred_stack <- stack(KEN_alt, KEN_bioclim_resamp, KEN_lakes_r_resamp,
longitude_raster, latitude_raster)
names(pred_stack) <- c('alt', 'bio12', 'lakes', 'long', 'lat')
matern2 <- spaMM::fitme(cbind(tri_np, round(tri_nneg)) ~
alt + bio12 + lakes +
Matern(1|lat+long),
data=STH_kenya_df, family=binomial())
predicted_risk <- raster::predict(pred_stack, matern2, type='response')
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
raster_colorPal <- colorNumeric(palette = topo.colors(64), domain = values(predicted_risk),
na.color = NA)
map_kenya <- basemap %>%
addRasterImage(x = predicted_risk, color = raster_colorPal) %>%
addPolygons(data = KEN_Adm_0, fillOpacity = 0, color = "grey", weight = 3)
map_kenya <- map_kenya %>%
addLegend(title = "Predicted risk, whipworm prevalence",
values = values(predicted_risk),
pal = raster_colorPal)
latitude_raster <- longitude_raster <- raster(nrows = KEN_alt %>% nrow(),
ncols = KEN_alt %>% ncol(),
ext = KEN_alt %>% extent())
longitude_raster[] <- coordinates(longitude_raster)[,1]
latitude_raster[] <- coordinates(latitude_raster)[,2]
pred_stack <- stack(KEN_alt, KEN_bioclim_resamp, KEN_lakes_r_resamp,
longitude_raster, latitude_raster)
names(pred_stack) <- c('alt', 'bio12', 'lakes', 'long', 'lat')
matern2 <- spaMM::fitme(cbind(tri_np, round(tri_nneg)) ~
alt + bio12 + lakes +
Matern(1|lat+long),
data=STH_kenya_df, family=binomial())
predicted_risk <- raster::predict(pred_stack, matern2, type='response')
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
raster_colorPal <- colorNumeric(palette = topo.colors(64), domain = values(predicted_risk),
na.color = NA)
map_kenya <- basemap %>%
addRasterImage(x = predicted_risk, color = raster_colorPal) %>%
addPolygons(data = KEN_Adm_0, fillOpacity = 0, color = "grey", weight = 3)
map_kenya <- map_kenya %>%
addLegend(title = "Predicted risk, whipworm prevalence",
values = values(predicted_risk),
pal = raster_colorPal)
latitude_raster <- longitude_raster <- raster(nrows = KEN_alt %>% nrow(),
ncols = KEN_alt %>% ncol(),
ext = KEN_alt %>% extent())
longitude_raster[] <- coordinates(longitude_raster)[,1]
latitude_raster[] <- coordinates(latitude_raster)[,2]
pred_stack <- stack(KEN_alt, KEN_bioclim_resamp, KEN_lakes_r_resamp,
longitude_raster, latitude_raster)
names(pred_stack) <- c('alt', 'bio12', 'lakes', 'long', 'lat')
matern2 <- spaMM::fitme(cbind(tri_np, round(tri_nneg)) ~
alt + bio12 + lakes +
Matern(1|lat+long),
data=STH_kenya_df, family=binomial())
predicted_risk <- raster::predict(pred_stack, matern2, type='response')
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
raster_colorPal <- colorNumeric(palette = topo.colors(64), domain = values(predicted_risk),
na.color = NA)
map_kenya <- basemap %>%
addRasterImage(x = predicted_risk, color = raster_colorPal) %>%
addPolygons(data = KEN_Adm_0, fillOpacity = 0, color = "grey", weight = 3)
map_kenya <- map_kenya %>%
addLegend(title = "Predicted risk, whipworm prevalence",
values = values(predicted_risk),
pal = raster_colorPal)
latitude_raster <- longitude_raster <- raster(nrows = KEN_alt %>% nrow(),
ncols = KEN_alt %>% ncol(),
ext = KEN_alt %>% extent())
longitude_raster[] <- coordinates(longitude_raster)[,1]
latitude_raster[] <- coordinates(latitude_raster)[,2]
pred_stack <- stack(KEN_alt, KEN_bioclim_resamp, KEN_lakes_r_resamp,
longitude_raster, latitude_raster)
names(pred_stack) <- c('alt', 'bio12', 'lakes', 'long', 'lat')
matern2 <- spaMM::fitme(cbind(tri_np, round(tri_nneg)) ~
alt + bio12 + lakes +
Matern(1|lat+long),
data=STH_kenya_df, family=binomial())
predicted_risk <- raster::predict(pred_stack, matern2, type='response')
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
raster_colorPal <- colorNumeric(palette = topo.colors(64), domain = values(predicted_risk),
na.color = NA)
map_kenya <- basemap %>%
addRasterImage(x = predicted_risk, color = raster_colorPal) %>%
addPolygons(data = KEN_Adm_0, fillOpacity = 0, color = "grey", weight = 3)
map_kenya <- map_kenya %>%
addLegend(title = "Predicted risk, whipworm prevalence",
values = values(predicted_risk),
pal = raster_colorPal)
options(scipen = 999)
matern <- spaMM::fitme(cbind(tri_np, round(tri_nneg)) ~
alt + bio12 + lakes +
Matern(1|lat+long),
data=STH_kenya_df, family=binomial())
matern %>% summary()
matern
View(matern)
matern$fixef
matern$fixef[[2]]
matern$fixef[[2]] %>% exp()
matern$fixef[[3]] %>% exp()
glm_mod_1 %>% summary()
options(scipen = 999)
glm_mod_1 %>% summary()
options(scipen = -12)
glm_mod_1 %>% summary()
map_kenya
options(scipen = 999)
glm_mod_1 <- glm(cbind(tri_np, round(tri_nneg)) ~
alt + bio12 + lakes,
data=STH_kenya_df, family=binomial())
glm_mod_1 %>% summary()
glm_mod_1
View(glm_mod_1)
glm_mod_1$effects
# roads_r %>% plot(main="Rasterized density of roads, Kenya, 1992 Digital Chart of the World",
#                  xlab = "Latitude", ylab = "longitude")
# roads %>% lines()
# KEN_Adm_0 %>% lines()
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
raster_colorPal <- colorNumeric(palette = topo.colors(64), domain = values(roads_r),
na.color = NA)
map_kenya <- basemap %>%
addRasterImage(x = roads_r, color = raster_colorPal) %>%
addPolylines(data = roads, weight=1.5, color = "dimgrey") %>%
addPolygons(data = KEN_Adm_0, fillOpacity = 0, color = "grey", weight = 3)
map_kenya <- map_kenya %>%
addLegend(title = "Predicted risk, whipworm prevalence",
values = values(roads_r),
pal = raster_colorPal)
roads_r %>% plot(main="Rasterized density of roads, Kenya, 1992 Digital Chart of the World",
xlab = "Latitude", ylab = "longitude")
# roads %>% lines()
# KEN_Adm_0 %>% lines()
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
raster_colorPal <- colorNumeric(palette = topo.colors(64), domain = values(roads_r),
na.color = NA)
map_kenya <- basemap %>%
addRasterImage(x = roads_r, color = raster_colorPal) %>%
addPolylines(data = roads, weight=1.5, color = "dimgrey") %>%
addPolygons(data = KEN_Adm_0, fillOpacity = 0, color = "grey", weight = 3)
map_kenya <- map_kenya %>%
addLegend(title = "Predicted risk, whipworm prevalence",
values = values(roads_r),
pal = raster_colorPal)
roads_r %>% plot(main="Rasterized density of roads, Kenya, 1992 Digital Chart of the World",
xlab = "Latitude", ylab = "longitude")
# roads %>% lines()
# KEN_Adm_0 %>% lines()
raster_colorPal <- colorNumeric(palette = topo.colors(64), domain = values(roads_r),
na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
# map_kenya <- basemap %>%
#   addRasterImage(x = roads_r, color = raster_colorPal) %>%
#   addPolylines(data = roads, weight=1.5, color = "dimgrey") %>%
#   addPolygons(data = KEN_Adm_0, fillOpacity = 0, color = "grey", weight = 3)
#
# map_kenya <- map_kenya %>%
#   addLegend(title = "Predicted risk, whipworm prevalence",
#             values = values(roads_r),
#             pal = raster_colorPal)
# roads_r %>% plot(main="Rasterized density of roads, Kenya, 1992 Digital Chart of the World",
#                   xlab = "Latitude", ylab = "longitude")
# roads %>% lines()
# KEN_Adm_0 %>% lines()
raster_colorPal <- colorNumeric(palette = topo.colors(64), domain = values(roads_r),
na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
# map_kenya <- basemap %>%
#   addRasterImage(x = roads_r, color = raster_colorPal) %>%
#   addPolylines(data = roads, weight=1.5, color = "dimgrey") %>%
#   addPolygons(data = KEN_Adm_0, fillOpacity = 0, color = "grey", weight = 3)
#
# map_kenya <- map_kenya %>%
#   addLegend(title = "Predicted risk, whipworm prevalence",
#             values = values(roads_r),
#             pal = raster_colorPal)
# roads_r %>% plot(main="Rasterized density of roads, Kenya, 1992 Digital Chart of the World",
#                   xlab = "Latitude", ylab = "longitude")
# roads %>% lines()
# KEN_Adm_0 %>% lines()
raster_colorPal <- colorNumeric(palette = topo.colors(64), domain = values(roads_r),
na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = roads_r, color = raster_colorPal) %>%
addPolylines(data = roads, weight=1.5, color = "dimgrey") %>%
addPolygons(data = KEN_Adm_0, fillOpacity = 0, color = "grey", weight = 3)
#
# map_kenya <- map_kenya %>%
#   addLegend(title = "Predicted risk, whipworm prevalence",
#             values = values(roads_r),
#             pal = raster_colorPal)
roads_r
# roads_r %>% plot(main="Rasterized density of roads, Kenya, 1992 Digital Chart of the World",
#                   xlab = "Latitude", ylab = "longitude")
# roads %>% lines()
# KEN_Adm_0 %>% lines()
raster_colorPal <- colorNumeric(palette = topo.colors(64), domain = values(roads_r),
na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = roads_r, color = raster_colorPal)
# %>%
#   addPolylines(data = roads, weight=1.5, color = "dimgrey") %>%
#   addPolygons(data = KEN_Adm_0, fillOpacity = 0, color = "grey", weight = 3)
#
# map_kenya <- map_kenya %>%
#   addLegend(title = "Predicted risk, whipworm prevalence",
#             values = values(roads_r),
#             pal = raster_colorPal)
# roads_r %>% plot(main="Rasterized density of roads, Kenya, 1992 Digital Chart of the World",
#                   xlab = "Latitude", ylab = "longitude")
# roads %>% lines()
# KEN_Adm_0 %>% lines()
raster_colorPal <- colorNumeric(palette = topo.colors(64), domain = values(roads_r),
na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = roads_r, color = raster_colorPal)
map_kenya
# %>%
#   addPolylines(data = roads, weight=1.5, color = "dimgrey") %>%
#   addPolygons(data = KEN_Adm_0, fillOpacity = 0, color = "grey", weight = 3)
#
# map_kenya <- map_kenya %>%
#   addLegend(title = "Predicted risk, whipworm prevalence",
#             values = values(roads_r),
#             pal = raster_colorPal)
# roads_r %>% plot(main="Rasterized density of roads, Kenya, 1992 Digital Chart of the World",
#                   xlab = "Latitude", ylab = "longitude")
# roads %>% lines()
# KEN_Adm_0 %>% lines()
raster_colorPal <- colorNumeric(palette = topo.colors(64), domain = values(roads_r),
na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = roads_r, color = raster_colorPal) %>%
addPolylines(data = roads, weight=1.5, color = "dimgrey")
map_kenya
# %>%
#   addPolygons(data = KEN_Adm_0, fillOpacity = 0, color = "grey", weight = 3)
#
# map_kenya <- map_kenya %>%
#   addLegend(title = "Predicted risk, whipworm prevalence",
#             values = values(roads_r),
#             pal = raster_colorPal)
# roads_r %>% plot(main="Rasterized density of roads, Kenya, 1992 Digital Chart of the World",
#                   xlab = "Latitude", ylab = "longitude")
# roads %>% lines()
# KEN_Adm_0 %>% lines()
raster_colorPal <- colorNumeric(palette = terrain.colors(64), domain = values(roads_r),
na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = roads_r, color = raster_colorPal, opacity = 0.5) %>%
addPolylines(data = roads, weight=1.5, color = "dimgrey")
map_kenya
# %>%
#   addPolygons(data = KEN_Adm_0, fillOpacity = 0, color = "grey", weight = 3)
#
# map_kenya <- map_kenya %>%
#   addLegend(title = "Predicted risk, whipworm prevalence",
#             values = values(roads_r),
#             pal = raster_colorPal)
# roads_r %>% plot(main="Rasterized density of roads, Kenya, 1992 Digital Chart of the World",
#                   xlab = "Latitude", ylab = "longitude")
# roads %>% lines()
# KEN_Adm_0 %>% lines()
raster_colorPal <- colorNumeric(palette = terrain.colors(64), domain = values(roads_r),
na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = roads_r, color = raster_colorPal, opacity = 0.5) %>%
addPolylines(data = roads, weight=1.5, color = "dimgrey") %>%
addLegend(title = "Predicted risk, whipworm prevalence",
values = values(roads_r), pal = raster_colorPal)
map_kenya
roads_r %>% plot(main="Rasterized density of roads, Kenya, 1992 Digital Chart of the World",
xlab = "Latitude", ylab = "longitude")
roads %>% lines()
KEN_Adm_0 %>% lines()
raster_colorPal <- colorNumeric(palette = terrain.colors(64), domain = values(roads_r),
na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = roads_r, color = raster_colorPal, opacity = 0.5) %>%
addPolylines(data = roads, weight=1.5, color = "dimgrey") %>%
addLegend(title = "Predicted risk, whipworm prevalence",
values = values(roads_r), pal = raster_colorPal)
map_kenya
roads_r %>% plot(main="Rasterized density of roads, Kenya, 1992 Digital Chart of the World",
xlab = "Latitude", ylab = "longitude")
roads %>% lines()
KEN_Adm_0 %>% lines()
raster_colorPal <- colorNumeric(palette = terrain.colors(64), reverse = T, domain = values(roads_r), na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = roads_r, color = raster_colorPal, opacity = 0.5) %>%
addPolylines(data = roads, weight=1.5, color = "dimgrey") %>%
addLegend(title = "Predicted risk, whipworm prevalence",
values = values(roads_r), pal = raster_colorPal)
map_kenya
roads_r %>% plot(main="Rasterized density of roads, Kenya, 1992 Digital Chart of the World",
xlab = "Latitude", ylab = "longitude")
roads %>% lines()
KEN_Adm_0 %>% lines()
raster_colorPal <- colorNumeric(palette = terrain.colors(64), reverse = T, domain = values(roads_r), na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = roads_r, color = raster_colorPal, opacity = 0.5) %>%
addPolylines(data = roads, weight=1.5, color = "dimgrey") %>%
addLegend(title = "Density of roads",
values = values(roads_r), pal = raster_colorPal)
map_kenya
roads_r %>% plot(main="Rasterized density of roads, Kenya, 1992 Digital Chart of the World",
xlab = "Latitude", ylab = "longitude")
roads %>% lines()
KEN_Adm_0 %>% lines()
raster_colorPal <- colorNumeric(palette = terrain.colors(64), reverse = T, domain = values(roads_r), na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = roads_r, color = raster_colorPal, opacity = 0.5) %>%
addPolylines(data = roads, weight=1.5, color = "dimgrey") %>%
addLegend(title = "Density of roads, Kenya",
values = values(roads_r), pal = raster_colorPal)
map_kenya
raster_colorPal <- colorNumeric(palette = terrain.colors(64), reverse = T, domain = values(roads_r), na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = roads_r, color = raster_colorPal, opacity = 0.5) %>%
addPolylines(data = roads, weight=1.5, color = "dimgrey") %>%
addLegend(title = "Density of roads, Kenya",
values = values(roads_r), pal = raster_colorPal)
map_kenya
raster_colorPal <- colorNumeric(palette = terrain.colors(64), reverse = T, domain = values(lakes_r), na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = lakes_r, color = raster_colorPal, opacity = 0.5) %>%
addPolylines(data = roads, weight=1.5, color = "dimgrey") %>%
addLegend(title = "Density of lakes, Kenya, 1992 DCW",
values = values(lakes_r), pal = raster_colorPal)
map_kenya
raster_colorPal <- colorNumeric(palette = terrain.colors(64), reverse = T, domain = values(lakes_r), na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = lakes_r, color = raster_colorPal, opacity = 0.5) %>%
addPolygons(data = lakes, weight=1.5, color = "dodgerblue") %>%
addLegend(title = "Density of lakes, Kenya, 1992 DCW",
values = values(lakes_r), pal = raster_colorPal)
map_kenya
raster_colorPal <- colorNumeric(palette = hcl.colors(64), reverse = T, domain = values(lakes_r), na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = lakes_r, color = raster_colorPal, opacity = 0.5) %>%
addPolygons(data = lakes, weight=1.5, color = "dodgerblue") %>%
addLegend(title = "Density of lakes, Kenya, 1992 DCW",
values = values(lakes_r), pal = raster_colorPal)
map_kenya
raster_colorPal <- colorNumeric(palette = grey.colors(64), reverse = T, domain = values(lakes_r), na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = lakes_r, color = raster_colorPal, opacity = 0.5) %>%
addPolygons(data = lakes, weight=1.5, color = "dodgerblue") %>%
addLegend(title = "Density of lakes, Kenya, 1992 DCW",
values = values(lakes_r), pal = raster_colorPal)
map_kenya
raster_colorPal <- colorNumeric(palette = topo.colors(64), reverse = T, domain = values(lakes_r), na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = lakes_r, color = raster_colorPal, opacity = 0.5) %>%
addPolygons(data = lakes, weight=1.5, color = "lightblue") %>%
addLegend(title = "Density of lakes, Kenya, 1992 DCW",
values = values(lakes_r), pal = raster_colorPal)
map_kenya
# rasterize lakes ----
ext <-  extent(33.90959, 41.92622, -4.720417, 5.061166)
xy <- ext %>% bbox() %>% as.matrix() %>% apply(1, diff) %>% abs()
n <- 5
r <- raster(ext, ncol=xy[1]*n, nrow=xy[2]*n)
lakes_r <- lakes %>% rasterize(r, fun='first')
raster_colorPal <- colorNumeric(palette = hcl.colors(64), reverse = T, domain = values(lakes_r), na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = lakes_r, color = raster_colorPal, opacity = 0.5) %>%
addPolygons(data = lakes, weight=1.5, color = "lightblue") %>%
addLegend(title = "Density of lakes, Kenya, 1992 DCW",
values = values(lakes_r), pal = raster_colorPal)
map_kenya
raster_colorPal <- colorNumeric(palette = hcl.colors(64), reverse = T, domain = values(lakes_r), na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = lakes_r, color = raster_colorPal, opacity = 0.5) %>%
addPolygons(data = lakes, weight=1.5, color = "lightblue") %>%
addLegend(title = "Density of lakes, Kenya, 1992 DCW",
values = values(lakes_r), pal = raster_colorPal)
map_kenya
# rasterize lakes ----
ext <-  extent(33.90959, 41.92622, -4.720417, 5.061166)
xy <- ext %>% bbox() %>% as.matrix() %>% apply(1, diff) %>% abs()
n <- 5
r <- raster(ext, ncol=xy[1]*n, nrow=xy[2]*n)
lakes_r <- lakes %>% rasterize(r, fun='first')
raster_colorPal <- colorNumeric(palette = terrain.colors(64), reverse = T, domain = values(roads_r), na.color = NA)
basemap <- leaflet() %>% addProviderTiles("CartoDB.Positron")
map_kenya <- basemap %>%
addRasterImage(x = roads_r, color = raster_colorPal, opacity = 0.5) %>%
addPolylines(data = roads, weight=1.5, color = "dimgrey") %>%
addLegend(title = "Density of roads, Kenya, 1992 DCW",
values = values(roads_r), pal = raster_colorPal)
map_kenya
# rasterize roads ----
rs <- raster(extent(roads), crs=projection(wgs84))
rs[] <- 1:ncell(rs)
rsp <- rs %>% rasterToPolygons()
rp <- roads %>% raster::intersect(rsp)
rp$length <- rgeos::gLength(rp, byid=TRUE) / 1000
x <- tapply(rp$length, rp$layer, sum)
roads_r <- rs %>% raster()
roads_r[as.integer(names(x))] <- x
# rasterize roads ----
rs <- raster(extent(roads), crs=projection(wgs84))
rs[] <- 1:ncell(rs)
rsp <- rs %>% rasterToPolygons()
rp <- roads %>% raster::intersect(rsp)
rp$length <- rgeos::gLength(rp, byid=TRUE) / 1000
x <- tapply(rp$length, rp$layer, sum)
roads_r <- rs %>% raster()
roads_r[as.integer(names(x))] <- x
# rasterize roads ----
rs <- raster(extent(roads), crs=projection(wgs84))
rs[] <- 1:ncell(rs)
rsp <- rs %>% rasterToPolygons()
rp <- roads %>% raster::intersect(rsp)
rp$length <- rgeos::gLength(rp, byid=TRUE) / 1000
x <- tapply(rp$length, rp$layer, sum)
roads_r <- rs %>% raster()
roads_r[as.integer(names(x))] <- x
# rasterize canals ----
rs <- raster(extent(canals), crs=projection(wgs84))
rs[] <- 1:ncell(rs)
rsp <- rs %>% rasterToPolygons()
rp <- roads %>% raster::intersect(rsp)
rp$length <- rgeos::gLength(rp, byid=TRUE) / 1000
x <- tapply(rp$length, rp$layer, sum)
canals_r <- rs %>% raster()
canals_r[as.integer(names(x))] <- x
# canals_r %>% plot()
# canals %>% lines()
# KEN_Adm_0 %>% lines()
# rasterize railroads ----
rs <- raster(extent(railroads), crs=projection(wgs84))
rs[] <- 1:ncell(rs)
rsp <- rs %>% rasterToPolygons()
rp <- roads %>% raster::intersect(rsp)
rp$length <- rgeos::gLength(rp, byid=TRUE) / 1000
x <- tapply(rp$length, rp$layer, sum)
railroads_r <- rs %>% raster()
railroads_r[as.integer(names(x))] <- x
# railroads_r %>% plot()
# railroads %>% lines()
# KEN_Adm_0 %>% lines()
